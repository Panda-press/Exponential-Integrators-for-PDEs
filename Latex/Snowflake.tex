\section {Snowflakes}
Here we begin to look in the phase boundary of the formation of a snowflake.
We will use an adaptive grid and compaire the first and second order exponential integrator methods.
We will also compare the limitations of these methods for differnt krylov sizes.
\subsection{Formulation of problem}

We condider the problem on a domain $\Omega = \mathbb{R}_+ \times [4, 8] \times [4, 8]$.
The equaitions govening this phase boundary problem are as follows.
\begin{align*}
    \tau \frac{\partial \phi}{\partial t} &= \nabla \cdot D\nabla\phi +  \phi(1-\phi)m(\phi,T)\\
    \frac{\partial T}{\partial t} &= D_T \nabla ^2T + \frac{\partial \phi}{\partial t}\\
    \intertext{Substituting in $\frac{\partial \phi}{\partial t}$ into the second equation and rewriting in weak form gives the following}
    \int \frac{\partial \phi}{\partial t} v_{\phi} &=  \frac 1{\tau}\int \phi(1-\phi)m(\phi,T)v_{\phi} - D \nabla \phi \cdot \nabla v_{\phi}\\
    \int \frac{\partial T}{\partial t} v_T &= \int \frac 1{\tau}(\phi(1-\phi)m(\phi,T)v_T - \nabla v_T \cdot D \nabla \phi) - D_T \nabla v_T \cdot \nabla T
\end{align*}
\begin{figure}[h]
    \centering
    \includegraphics[width=0.5\textwidth]{Snowflakes/EXP1LAN/Snowflake_2--problem_1.0_0_16.png} % Change filename to your image
    \caption{Initial condition}
    \label{fig:initial}
\end{figure}
With an initial condition of: \ref{fig:initial}
\begin{align*}
    \phi(0,x,y) &= \begin{cases} 
      1 & (x - 6)^2 + (y - 6)^2 \leq 0.3 \\
      0 & \text{otherwise} \end{cases}\\
    T(0,x,y) &= -0.5 (0,x,y)\in \Omega
\end{align*}

Where we have that

\begin{align*}
    m(\phi, T) &= \phi - \frac 12 - \frac{\kappa_1}{\pi}arctan(\kappa_2 T)\\
    D &= \alpha^2(1+c\beta)
    \begin{pmatrix}
        1+c\beta & -c\frac{\partial\beta}{\partial\psi}\\
        c\frac{\partial\beta}{\partial\psi} & 1+c\beta
    \end{pmatrix}\\
    \text{With }\beta &= \frac{1-\Phi^2}{1+\Phi^2}\\
    \Phi &= tan(\frac N2\psi)\\
    \psi &= \theta + arctan(\frac{\frac{\partial \phi}{\partial y}}{\frac{\partial \phi}{\partial x}})\\
\end{align*}
and with the following constants
\begin{align*}
    \begin{matrix}
    D_T = 2.25 & \alpha = 0.015 & \tau = 3\cdot 10^{-4} & \kappa_1 &= 0.9\\
    \kappa_2 = 20 & c = 0.02 & N = 6 & \theta = \frac{\pi}8
    \end{matrix}
\end{align*}

\subsection{Numerical Solutions}
Here we begin the comparison of the differnet methods.
For all of them we will use a time step size of $0.0005$ and will run untill and end time of $0.1$.\\

We begin looking at the results for the first order method with a krylov subspace of dimention $16, 32$.

\begin{figure}[H]
    \centering
    \begin{minipage}{0.49\textwidth}
        \includegraphics[width=1\textwidth]{Snowflakes/EXP1LAN/Snowflake_2--problem_1.0_10_16.png} % Change filename to your image
        \caption{from First order exponential integrator with krylov size $16$}
        \label{fig:first order 16}
    \end{minipage}\hfill
    \centering
    \begin{minipage}{0.49\textwidth}
        \includegraphics[width=1\textwidth]{Snowflakes/EXP1LAN/Snowflake_2--problem_1.0_10_32.png} % Change filename to your image
        \caption{from First order exponential integrator with krylov size $32$}
        \label{fig:first order 32}
    \end{minipage}\hfill
\end{figure}

We observe that the snowflakes generated by both krylov sizes are near identical, 
suggesting that setting the dimention of the krylov space to $16$ is sufficient for this problem.\\

Moving on to the second order method we use a krylov size of $, $.

\subsection{Limitations}
Now we compare the limitations of the first and second order exponential methods when the dimention of the krylov space is smaller that for what we saw above.
We compare it for krylov sizes of $8$ and $12$.

When an exponentially small subspace is used such as $8$ as shown in figure %cite figure
we observe that the snowflake continuses to grow in the shape of a smooth hexagon without forming any dendrites.
When we use a subspace of size $12$ we observe that while dendrites now form they are stubbier and produce less branching.